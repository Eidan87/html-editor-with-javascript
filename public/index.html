<!DOCTYPE html>
<html>
<head>
  <title>Subir archivos</title>
  <link rel="stylesheet" type="text/css" href="styles.css">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    h1 {
      text-align: center;
    }
 
    form {
      text-align: center;
      margin-top: 20px;
    }

    #fileContainer {
      margin-top: 20px;
    }

    #fileContainer a {
      display: block;
      margin-bottom: 5px;
      color: #333;
      text-decoration: none;
    }

    #fileContainer a:hover {
      text-decoration: underline;
    }


  .file-item {
    display: flex;
    align-items: center;
    margin-bottom: 5px;
  }

  .file-icon {
    margin-right: 5px;
  }

  .file-link {
    color: #333;
    text-decoration: none;
  }

  .file-link:hover {
    text-decoration: underline;
  }


  </style>
</head>
<body>
  <h1>Subir archivos</h1>
  <form id="uploadForm" action="/upload" method="post" enctype="multipart/form-data">
    <input type="file" name="files" multiple>
    <input type="submit" value="Subir archivos">
  </form>

  <div id="fileContainer"></div>

  <script>
    function cargarHTML(fileUrl) {
      window.location.href = `editor.html?file=${encodeURIComponent(fileUrl)}`;
    }
  
    function createFolder() {
      const folderName = prompt('Ingrese el nombre de la carpeta');
      if (folderName) {
        fetch('/create-folder', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ folderName })
        })
        .then(response => response.json())
        .then(result => {
          if (result.success) {
            window.location.reload();
          } else {
            alert(result.message);
          }
        })
        .catch(error => {
          console.error(error);
          alert('Error al crear la carpeta');
        });
      }
    }
  
    document.addEventListener('DOMContentLoaded', function() {
      const fileContainer = document.getElementById('fileContainer');
  
      fetch('/uploads')
        .then(response => response.json())
        .then(files => {
          files.forEach(file => {
  const fileItem = document.createElement('div');
  fileItem.classList.add('file-item');

  const fileIcon = document.createElement('img');
  fileIcon.src = 'icon.png'; // Reemplaza "file-icon.png" con la ruta a tu icono de archivo
  fileIcon.classList.add('file-icon');
  fileItem.appendChild(fileIcon);

  const fileLink = document.createElement('a');
  fileLink.href = `uploads/${encodeURIComponent(file)}`;
  fileLink.textContent = file;
  fileLink.classList.add('file-link');
  fileLink.addEventListener('click', function(e) {
    e.preventDefault();
    const fileUrl = this.getAttribute('href');
    cargarHTML(fileUrl);
  });
  fileItem.appendChild(fileLink);

  const deleteButton = document.createElement('button');
  deleteButton.textContent = 'Eliminar';
  deleteButton.addEventListener('click', function() {
    if (confirm('¿Estás seguro de eliminar este archivo?')) {
      const fileName = encodeURIComponent(file);
      fetch(`/uploads/${fileName}`, {
        method: 'DELETE'
      })
      .then(response => response.json())
      .then(result => {
        if (result.success) {
          fileItem.remove();
        } else {
          alert(result.message);
        }
      })
      .catch(error => {
        console.error(error);
        alert('Error al eliminar el archivo');
      });
    }
  });
  fileItem.appendChild(deleteButton);

  fileContainer.appendChild(fileItem);
});

        })
        .catch(error => {
          console.error(error);
        });
    });
  </script>
  
</body>
</html>
